<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
    <head>
        
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />

        <title>Using web events to do dialoguing &middot; Global Constant</title>
        <link rel='stylesheet' href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,600' type='text/css'>
        <link rel="stylesheet" href="http://blog.scnay.com/css/main.min.css" />
        <link rel="alternate" href="" type="application/rss+xml" title="Global Constant" />
        <style type="text/css">
            .alignright {
                float: right;
            }
        </style>
    </head>
    <body class="li-body">

<header class="li-page-header">
    <div class="container">
        <div class="row">
            <div class="sixteen columns">
                <div class="li-brand li-left">
                <a href="http://blog.scnay.com">Global Constant</a>
                <br />Steve Nay&#39;s ramblings</div>
                <div class="li-menu li-right">
                    <span class="li-menu-icon" onclick="javascript:toggle('menu');">&#9776;</span>
                    <ul id="menu2" class="li-menu-items">
                        <li><a href="/archive">Archives</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="sixteen columns">
                <ul id="menu" class="li-menu-items li-menu-mobile">
                    <li><a href="/archive">Archives</a></li>
                </ul>
            </div>
        </div>
    </div>
</header>


    <div class="container">
        <div class="row">
            <div class="sixteen columns">
                <article class="li-article">
                    <header class="li-article-header">
                        <h1 class="li-article-title">Using web events to do dialoguing</h1>
                        <time class="li-article-date">Tuesday 21 June 2011</time>
                    </header>
                    <section>
                        <p>My <a href="/2011/06/17/combining-client-side-processing-with-server-side-in-krl/">last post</a> was about using an HTML form with KRL to get data from a page and submit it back to the server. This post describes another method for doing the same thing, but this method is less vulnerable to interference from other code on the site.</p>

<p>I&rsquo;m writing an application that runs on Facebook. Unfortunately, Facebook munges HTML forms somehow, making it impossible to do dialoguing the way I explained last week. This new method does not depend on the behavior of HTML forms, so it works great even on a JavaScript-heavy site like Facebook.</p>

<p>Here&rsquo;s the process:</p>

<ol>
<li>Like before, we use jQuery to get the information we want. This could be data extracted from the page, or it could be input provided by the user.</li>
<li>Using JavaScript and the KOBJ object, we get a reference to the ruleset that we want to handle the data.</li>
<li>With that reference, we raise a web event in the ruleset and pass along the data we collected from the page.</li>
<li>The ruleset then handles the event and returns any appropriate directives.</li>
</ol>

<p>In my application, I&rsquo;m asking the user for a first and last name to search the BYU directory. I put an HTML form on the page to collect that information. Then there is a JavaScript function that runs when the user clicks the &ldquo;Search&rdquo; button. That function pulls the data out of the form and raises an event with that data to my ruleset. Here&rsquo;s how that part looks:</p>

<script src="https://gist.github.com/1038785.js?file=draw.js"></script>

<p>(You&rsquo;ll also notice that I&rsquo;m setting the <code>page_params.kynetx_app_version</code> to be <code>&ldquo;dev&rdquo;</code>. This is due to the way I structured my application; I need that so that I don&rsquo;t have to deploy the ruleset every time. You probably won&rsquo;t need to do this, but <a href="https://convore.com/kynetx/raising-events-in-called-rulesets/">read more here</a> if you&rsquo;re interested anyway.)</p>

<p>The rule that handles the event is very straightforward. Here&rsquo;s what it looks like:</p>

<script src="https://gist.github.com/1038785.js?file=handle.js"></script>

<p>The function <code>listnames()</code> is defined in the global block, but it&rsquo;s not really relevant to this discussion.</p>

                    </section>
                </article>
            </div>
        </div>
        <div class="row li-pagination">
            <div class="eight columns">
                <div class="li-pagination-previous">
                    
                        Later article<br />
                        <a href="http://blog.scnay.com/2011/06/21/using-google-apps-script-with-kynetx"> Using Google Apps Script with Kynetx</a>
                    
                </div>
            </div>
            <div class="eight columns">
                <div class="li-pagination-next">
                    
                        Older article<br />
                        <a href="http://blog.scnay.com/2011/06/17/combining-client-side-processing-with-server-side-in-krl"> Combining client-side processing with server-side in KRL</a>
                    
                </div>
            </div>
        </div>
    </div>

<footer class="li-page-footer">
    <div class="container">
        <div class="row">
            <div class="sixteen columns">
                <div class="li-page-footer-legal">
                    Licensed under <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC Attribution-ShareAlike 4.0 International</a>
                </div>
                <div class="li-page-footer-theme">
                    <span class="">Powered by <a href="http://hugo.spf13.com/">hugo</a>. Theme based on <a href="http://github.com/eliasson/liquorice/">liquorice</a>.</span>
                </div>
            </div>
        </div>
    </div>
</footer>

    <script type="text/javascript">
    <!--
    function toggle(id) {
        var e = document.getElementById(id);
        e.style.display == 'block' ? e.style.display = 'none' : e.style.display = 'block';
    }
    
    </script>
    </body>
</html>

